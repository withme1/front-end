{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { useOpenState } from './useOpenState';\nimport { useUtils } from './useUtils';\nexport const usePickerState = (props, valueManager) => {\n  const {\n    disableCloseOnSelect,\n    onAccept,\n    onChange,\n    value\n  } = props;\n  const utils = useUtils();\n  const {\n    isOpen,\n    setIsOpen\n  } = useOpenState(props);\n\n  function initDraftableDate(date) {\n    return {\n      committed: date,\n      draft: date\n    };\n  }\n\n  const parsedDateValue = React.useMemo(() => valueManager.parseInput(utils, value), [valueManager, utils, value]);\n  const [lastValidDateValue, setLastValidDateValue] = React.useState(parsedDateValue);\n  React.useEffect(() => {\n    if (parsedDateValue != null) {\n      setLastValidDateValue(parsedDateValue);\n    }\n  }, [parsedDateValue]);\n  const [draftState, dispatch] = React.useReducer((state, action) => {\n    switch (action.type) {\n      case 'reset':\n        return initDraftableDate(action.payload);\n\n      case 'update':\n        return _extends({}, state, {\n          draft: action.payload\n        });\n\n      default:\n        return state;\n    }\n  }, parsedDateValue, initDraftableDate);\n\n  if (!valueManager.areValuesEqual(utils, draftState.committed, parsedDateValue)) {\n    dispatch({\n      type: 'reset',\n      payload: parsedDateValue\n    });\n  }\n\n  const [initialDate, setInitialDate] = React.useState(draftState.committed); // Mobile keyboard view is a special case.\n  // When it's open picker should work like closed, because we are just showing text field\n\n  const [isMobileKeyboardViewOpen, setMobileKeyboardViewOpen] = React.useState(false);\n  const acceptDate = React.useCallback((acceptedDate, needClosePicker) => {\n    onChange(acceptedDate);\n\n    if (needClosePicker) {\n      setIsOpen(false);\n      setInitialDate(acceptedDate);\n\n      if (onAccept) {\n        onAccept(acceptedDate);\n      }\n    }\n  }, [onAccept, onChange, setIsOpen]);\n  const wrapperProps = React.useMemo(() => ({\n    open: isOpen,\n    onClear: () => acceptDate(valueManager.emptyValue, true),\n    onAccept: () => acceptDate(draftState.draft, true),\n    onDismiss: () => acceptDate(initialDate, true),\n    onSetToday: () => {\n      const now = utils.date();\n      dispatch({\n        type: 'update',\n        payload: now\n      });\n      acceptDate(now, !disableCloseOnSelect);\n    }\n  }), [acceptDate, disableCloseOnSelect, isOpen, utils, draftState.draft, valueManager.emptyValue, initialDate]);\n  const pickerProps = React.useMemo(() => ({\n    date: draftState.draft,\n    isMobileKeyboardViewOpen,\n    toggleMobileKeyboardView: () => setMobileKeyboardViewOpen(!isMobileKeyboardViewOpen),\n    onDateChange: function (newDate, wrapperVariant) {\n      let selectionState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'partial';\n      dispatch({\n        type: 'update',\n        payload: newDate\n      });\n\n      if (selectionState === 'partial') {\n        acceptDate(newDate, false);\n      }\n\n      if (selectionState === 'finish') {\n        const shouldCloseOnSelect = !(disableCloseOnSelect != null ? disableCloseOnSelect : wrapperVariant === 'mobile');\n        acceptDate(newDate, shouldCloseOnSelect);\n      } // if selectionState === \"shallow\" do nothing (we already update the draft state)\n\n    }\n  }), [acceptDate, disableCloseOnSelect, isMobileKeyboardViewOpen, draftState.draft]);\n  const handleInputChange = React.useCallback((date, keyboardInputValue) => {\n    const cleanDate = valueManager.valueReducer ? valueManager.valueReducer(utils, lastValidDateValue, date) : date;\n    onChange(cleanDate, keyboardInputValue);\n  }, [onChange, valueManager, lastValidDateValue, utils]);\n  const inputProps = React.useMemo(() => ({\n    onChange: handleInputChange,\n    open: isOpen,\n    rawValue: value,\n    openPicker: () => setIsOpen(true)\n  }), [handleInputChange, isOpen, value, setIsOpen]);\n  const pickerState = {\n    pickerProps,\n    inputProps,\n    wrapperProps\n  };\n  React.useDebugValue(pickerState, () => ({\n    MuiPickerState: {\n      pickerDraft: draftState,\n      other: pickerState\n    }\n  }));\n  return pickerState;\n};","map":{"version":3,"names":["_extends","React","useOpenState","useUtils","usePickerState","props","valueManager","disableCloseOnSelect","onAccept","onChange","value","utils","isOpen","setIsOpen","initDraftableDate","date","committed","draft","parsedDateValue","useMemo","parseInput","lastValidDateValue","setLastValidDateValue","useState","useEffect","draftState","dispatch","useReducer","state","action","type","payload","areValuesEqual","initialDate","setInitialDate","isMobileKeyboardViewOpen","setMobileKeyboardViewOpen","acceptDate","useCallback","acceptedDate","needClosePicker","wrapperProps","open","onClear","emptyValue","onDismiss","onSetToday","now","pickerProps","toggleMobileKeyboardView","onDateChange","newDate","wrapperVariant","selectionState","shouldCloseOnSelect","handleInputChange","keyboardInputValue","cleanDate","valueReducer","inputProps","rawValue","openPicker","pickerState","useDebugValue","MuiPickerState","pickerDraft","other"],"sources":["/var/www/front-end/node_modules/@mui/x-date-pickers/internals/hooks/usePickerState.js"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { useOpenState } from './useOpenState';\nimport { useUtils } from './useUtils';\nexport const usePickerState = (props, valueManager) => {\n  const {\n    disableCloseOnSelect,\n    onAccept,\n    onChange,\n    value\n  } = props;\n  const utils = useUtils();\n  const {\n    isOpen,\n    setIsOpen\n  } = useOpenState(props);\n\n  function initDraftableDate(date) {\n    return {\n      committed: date,\n      draft: date\n    };\n  }\n\n  const parsedDateValue = React.useMemo(() => valueManager.parseInput(utils, value), [valueManager, utils, value]);\n  const [lastValidDateValue, setLastValidDateValue] = React.useState(parsedDateValue);\n  React.useEffect(() => {\n    if (parsedDateValue != null) {\n      setLastValidDateValue(parsedDateValue);\n    }\n  }, [parsedDateValue]);\n  const [draftState, dispatch] = React.useReducer((state, action) => {\n    switch (action.type) {\n      case 'reset':\n        return initDraftableDate(action.payload);\n\n      case 'update':\n        return _extends({}, state, {\n          draft: action.payload\n        });\n\n      default:\n        return state;\n    }\n  }, parsedDateValue, initDraftableDate);\n\n  if (!valueManager.areValuesEqual(utils, draftState.committed, parsedDateValue)) {\n    dispatch({\n      type: 'reset',\n      payload: parsedDateValue\n    });\n  }\n\n  const [initialDate, setInitialDate] = React.useState(draftState.committed); // Mobile keyboard view is a special case.\n  // When it's open picker should work like closed, because we are just showing text field\n\n  const [isMobileKeyboardViewOpen, setMobileKeyboardViewOpen] = React.useState(false);\n  const acceptDate = React.useCallback((acceptedDate, needClosePicker) => {\n    onChange(acceptedDate);\n\n    if (needClosePicker) {\n      setIsOpen(false);\n      setInitialDate(acceptedDate);\n\n      if (onAccept) {\n        onAccept(acceptedDate);\n      }\n    }\n  }, [onAccept, onChange, setIsOpen]);\n  const wrapperProps = React.useMemo(() => ({\n    open: isOpen,\n    onClear: () => acceptDate(valueManager.emptyValue, true),\n    onAccept: () => acceptDate(draftState.draft, true),\n    onDismiss: () => acceptDate(initialDate, true),\n    onSetToday: () => {\n      const now = utils.date();\n      dispatch({\n        type: 'update',\n        payload: now\n      });\n      acceptDate(now, !disableCloseOnSelect);\n    }\n  }), [acceptDate, disableCloseOnSelect, isOpen, utils, draftState.draft, valueManager.emptyValue, initialDate]);\n  const pickerProps = React.useMemo(() => ({\n    date: draftState.draft,\n    isMobileKeyboardViewOpen,\n    toggleMobileKeyboardView: () => setMobileKeyboardViewOpen(!isMobileKeyboardViewOpen),\n    onDateChange: (newDate, wrapperVariant, selectionState = 'partial') => {\n      dispatch({\n        type: 'update',\n        payload: newDate\n      });\n\n      if (selectionState === 'partial') {\n        acceptDate(newDate, false);\n      }\n\n      if (selectionState === 'finish') {\n        const shouldCloseOnSelect = !(disableCloseOnSelect != null ? disableCloseOnSelect : wrapperVariant === 'mobile');\n        acceptDate(newDate, shouldCloseOnSelect);\n      } // if selectionState === \"shallow\" do nothing (we already update the draft state)\n\n    }\n  }), [acceptDate, disableCloseOnSelect, isMobileKeyboardViewOpen, draftState.draft]);\n  const handleInputChange = React.useCallback((date, keyboardInputValue) => {\n    const cleanDate = valueManager.valueReducer ? valueManager.valueReducer(utils, lastValidDateValue, date) : date;\n    onChange(cleanDate, keyboardInputValue);\n  }, [onChange, valueManager, lastValidDateValue, utils]);\n  const inputProps = React.useMemo(() => ({\n    onChange: handleInputChange,\n    open: isOpen,\n    rawValue: value,\n    openPicker: () => setIsOpen(true)\n  }), [handleInputChange, isOpen, value, setIsOpen]);\n  const pickerState = {\n    pickerProps,\n    inputProps,\n    wrapperProps\n  };\n  React.useDebugValue(pickerState, () => ({\n    MuiPickerState: {\n      pickerDraft: draftState,\n      other: pickerState\n    }\n  }));\n  return pickerState;\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}