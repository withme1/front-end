{"ast":null,"code":"import _slicedToArray from\"/var/www/front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"/var/www/front-end/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;/** @jsxImportSource @emotion/react */import{css}from'@emotion/react';import{Button,TextField}from'@mui/material';import ChatView from'./ChatView';import{getSocket}from'../../socket/socket';import{useEffect,useRef,useState}from'react';import dayjs from'dayjs';import ChatRoomInfo from'./ChatRoomInfo';import{useMediaQuery}from'react-responsive';import{jsx as _jsx}from\"@emotion/react/jsx-runtime\";import{Fragment as _Fragment}from\"@emotion/react/jsx-runtime\";import{jsxs as _jsxs}from\"@emotion/react/jsx-runtime\";var chatStyle=css(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  height: 100%;\\n  width: 100%;\\n\\n  display: flex;\\n  flex-direction: column;\\n\"])));var checkMessage=function checkMessage(m){if(m==='')return false;return true;};function Chat(_ref){var roomList=_ref.roomList,remake=_ref.remake,setRemake=_ref.setRemake,isInRoom=_ref.isInRoom,setIsInRoom=_ref.setIsInRoom,isHost=_ref.isHost,setIsHost=_ref.setIsHost,roomId=_ref.roomId,setRoomId=_ref.setRoomId,chatList=_ref.chatList,setChatList=_ref.setChatList,addMessage=_ref.addMessage,setRoomList=_ref.setRoomList,chatStyleRef=_ref.chatStyleRef;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var chatHandler=function chatHandler(e){e.preventDefault();if(!isInRoom)return;if(checkMessage(message))getSocket().emit('sendMessageReq',{message:message.trim(),time:dayjs().format('HH:mm:ss')});};useEffect(function(){getSocket().removeAllListeners(\"sendMessageRes\");getSocket().on('sendMessageRes',function(res){if(res.ok){addMessage({type:'me',text:res.message,time:dayjs('2020-01-01 '+res.time)});setMessage('');}else{alert(res.reason);}});getSocket().removeAllListeners(\"messageReceived\");getSocket().on('messageReceived',function(res){addMessage({type:'other',text:res.message,time:dayjs('2020-01-01 '+res.time)});});},[]);var isPC=useMediaQuery({query:\"(min-width: 700px)\"});var textFieldStyle={flexGrow:'1','.MuiOutlinedInput-root':{height:'100%'},'.MuiOutlinedInput-root input':{padding:\"5px;\",fontSize:isPC?'1em':'1.3em',height:'100%'},'.MuiOutlinedInput-root fieldset':{borderColor:'green'},'.MuiOutlinedInput-root.Mui-focused fieldset':{borderColor:'green'}};var sendButtonStyle={boxShadow:\"0 0 0\",backgroundColor:\"#2BAE66\",padding:\"0px\",fontSize:'0.8em',width:isPC?'45px':'80px',minWidth:'none',\"&:hover\":{boxShadow:\"0 0 0\",backgroundColor:\"#2BAE66\"}};return _jsxs(\"div\",{css:chatStyle,children:[isInRoom?_jsx(ChatRoomInfo,{room:roomList.find(function(room){return room.id===roomId;}),isInRoom:isInRoom,isHost:isHost}):_jsx(_Fragment,{}),_jsx(ChatView,{chatList:chatList,setChatList:setChatList,chatStyleRef:chatStyleRef}),_jsxs(\"form\",{css:css(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"display: flex; height: \",\";\"])),isPC?'30px':'40px'),onSubmit:chatHandler,children:[_jsx(TextField,{autoComplete:\"off\",sx:textFieldStyle,value:message,onChange:function onChange(e){return setMessage(e.target.value);}}),_jsx(Button,{variant:\"contained\",sx:sendButtonStyle,onClick:chatHandler,children:\"\\uBCF4\\uB0B4\\uAE30\"})]})]});}export default Chat;","map":{"version":3,"names":["css","Button","TextField","ChatView","getSocket","useEffect","useRef","useState","dayjs","ChatRoomInfo","useMediaQuery","chatStyle","checkMessage","m","Chat","roomList","remake","setRemake","isInRoom","setIsInRoom","isHost","setIsHost","roomId","setRoomId","chatList","setChatList","addMessage","setRoomList","chatStyleRef","message","setMessage","chatHandler","e","preventDefault","emit","trim","time","format","removeAllListeners","on","res","ok","type","text","alert","reason","isPC","query","textFieldStyle","flexGrow","height","padding","fontSize","borderColor","sendButtonStyle","boxShadow","backgroundColor","width","minWidth","find","room","id","target","value"],"sources":["/var/www/front-end/src/main/chat/Chat.js"],"sourcesContent":["/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Button, TextField } from '@mui/material';\nimport ChatView from './ChatView';\nimport { getSocket } from '../../socket/socket'\nimport { useEffect, useRef, useState } from 'react';\nimport dayjs from 'dayjs';\nimport ChatRoomInfo from './ChatRoomInfo';\nimport { useMediaQuery } from 'react-responsive';\n\nconst chatStyle = css`\n  height: 100%;\n  width: 100%;\n\n  display: flex;\n  flex-direction: column;\n`;\n\nconst checkMessage = (m) => {\n  if (m === '')\n    return false;\n  return true;\n}\n\nfunction Chat({ roomList, remake, setRemake, isInRoom, setIsInRoom, isHost, setIsHost, roomId, setRoomId, chatList, setChatList, addMessage, setRoomList, chatStyleRef }) {\n  const [message, setMessage] = useState('');\n\n  const chatHandler = (e) => {\n    e.preventDefault();\n    if (!isInRoom)\n      return;\n\n    if (checkMessage(message))\n      getSocket().emit('sendMessageReq', { message: message.trim(), time: dayjs().format('HH:mm:ss') });\n  }\n\n  useEffect(() => {\n    getSocket().removeAllListeners(\"sendMessageRes\");\n    getSocket().on('sendMessageRes', (res) => {\n      if (res.ok) {\n        addMessage({ type: 'me', text: res.message, time: dayjs('2020-01-01 ' + res.time) });\n        setMessage('');\n      } else {\n        alert(res.reason)\n      }\n    })\n    getSocket().removeAllListeners(\"messageReceived\");\n    getSocket().on('messageReceived', (res) => {\n      addMessage({ type: 'other', text: res.message, time: dayjs('2020-01-01 ' + res.time) });\n    })\n  }, [])\n\n  const isPC = useMediaQuery({query : \"(min-width: 700px)\"});\n\n  const textFieldStyle = {\n    flexGrow: '1',\n    '.MuiOutlinedInput-root': {\n      height: '100%'\n    },\n    '.MuiOutlinedInput-root input': {\n      padding: \"5px;\",\n      fontSize: isPC ? '1em' : '1.3em',\n      height: '100%',\n    },\n    '.MuiOutlinedInput-root fieldset': {\n      borderColor: 'green',\n    },\n    '.MuiOutlinedInput-root.Mui-focused fieldset': {\n      borderColor: 'green',\n    }\n  };\n  \n  const sendButtonStyle = {\n    boxShadow: \"0 0 0\",\n    backgroundColor: \"#2BAE66\",\n    padding: \"0px\",\n    fontSize: '0.8em',\n    width: isPC ? '45px' : '80px',\n    \n    minWidth: 'none',\n  \n    \"&:hover\": {\n      boxShadow: \"0 0 0\",\n      backgroundColor: \"#2BAE66\"\n    }\n  };\n\n  return (\n    <div css={chatStyle}>\n      { isInRoom ? <ChatRoomInfo room={roomList.find(room => room.id === roomId)} isInRoom={isInRoom} isHost={isHost}/> : <></>}\n      <ChatView chatList={chatList} setChatList={setChatList} chatStyleRef={chatStyleRef} />\n      <form css={css`display: flex; height: ${isPC ? '30px' : '40px'};`} onSubmit={chatHandler}>\n        <TextField autoComplete='off' sx={textFieldStyle} value={message} onChange={(e) => setMessage(e.target.value)} />\n        <Button variant=\"contained\" sx={sendButtonStyle} onClick={chatHandler}>보내기</Button>\n      </form>\n    </div>\n  )\n}\n\nexport default Chat;"],"mappings":"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"},"metadata":{},"sourceType":"module"}