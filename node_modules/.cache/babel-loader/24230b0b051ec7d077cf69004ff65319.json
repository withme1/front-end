{"ast":null,"code":"import _taggedTemplateLiteral from\"/var/www/front-end/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _toConsumableArray from\"/var/www/front-end/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/var/www/front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject;/** @jsxImportSource @emotion/react */import{css}from'@emotion/react';import{useEffect,useRef,useState}from'react';import ComputerChat from'./chat/ComputerChat';import MobileChat from'./chat/MobileChat';import RoomList from'./room/RoomList';import{getSocket}from'../socket/socket';import{useMediaQuery}from'react-responsive';import{jsx as _jsx}from\"@emotion/react/jsx-runtime\";import{Fragment as _Fragment}from\"@emotion/react/jsx-runtime\";import{jsxs as _jsxs}from\"@emotion/react/jsx-runtime\";function Main(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),roomList=_useState2[0],setRoomList=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isInRoom=_useState4[0],setIsInRoom=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isHost=_useState6[0],setIsHost=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),roomId=_useState8[0],setRoomId=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),chatList=_useState10[0],setChatList=_useState10[1];var chatStyleRef=useRef();var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),remake=_useState12[0],setRemake=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),rejoin=_useState14[0],setRejoin=_useState14[1];var _useState15=useState(new Set()),_useState16=_slicedToArray(_useState15,2),fullIds=_useState16[0],setFullIds=_useState16[1];var addMessage=function addMessage(m){setChatList(function(prev){return[].concat(_toConsumableArray(prev),[m]);});};var clearMessage=function clearMessage(){setChatList([]);};useEffect(function(){if(chatStyleRef.current)chatStyleRef.current.scrollTop=chatStyleRef.current.scrollHeight;},[chatList]);useEffect(function(){getSocket().on('roomDeleted',function(id){setRoomList(function(prev){return prev.filter(function(room){return room.id!==id;});});});},[]);useEffect(function(){getSocket().removeAllListeners(\"roomDeletedC\");getSocket().on('roomDeletedC',function(){if(isInRoom&&!isHost){addMessage({type:'system',text:'방 삭제됨'});setIsInRoom(false);setIsHost(false);setRoomId(null);}});getSocket().removeAllListeners(\"roomQuited\");getSocket().on('roomQuited',function(){if(isInRoom&&isHost){addMessage({type:'system',text:'상대 퇴장'});setIsInRoom(true);setIsHost(true);setRoomId(roomId);}});},[isInRoom]);var isPC=useMediaQuery({query:\"(min-width: 700px)\"});var mainStyle=css(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n        display: flex;\\n        flex-direction: \",\";\\n        align-items: stretch;\\n    \"])),isPC?'row':'column');return _jsxs(\"div\",{className:\"main\",css:mainStyle,children:[isPC?_jsx(ComputerChat,{roomList:roomList,rejoin:rejoin,setRejoin:setRejoin,remake:remake,setRemake:setRemake,isInRoom:isInRoom,setIsInRoom:setIsInRoom,isHost:isHost,setIsHost:setIsHost,roomId:roomId,setRoomId:setRoomId,chatList:chatList,setChatList:setChatList,addMessage:addMessage,setRoomList:setRoomList,chatStyleRef:chatStyleRef}):_jsx(_Fragment,{}),_jsx(RoomList,{clearMessage:clearMessage,fullIds:fullIds,setFullIds:setFullIds,rejoin:rejoin,setRejoin:setRejoin,remake:remake,setRemake:setRemake,roomList:roomList,setRoomList:setRoomList,isInRoom:isInRoom,setIsInRoom:setIsInRoom,isHost:isHost,setIsHost:setIsHost,roomId:roomId,setRoomId:setRoomId,addMessage:addMessage}),isPC?_jsx(_Fragment,{}):_jsx(MobileChat,{roomList:roomList,rejoin:rejoin,setRejoin:setRejoin,remake:remake,setRemake:setRemake,isInRoom:isInRoom,setIsInRoom:setIsInRoom,isHost:isHost,setIsHost:setIsHost,roomId:roomId,setRoomId:setRoomId,chatList:chatList,setChatList:setChatList,addMessage:addMessage,setRoomList:setRoomList,chatStyleRef:chatStyleRef})]});}export default Main;","map":{"version":3,"names":["css","useEffect","useRef","useState","ComputerChat","MobileChat","RoomList","getSocket","useMediaQuery","Main","roomList","setRoomList","isInRoom","setIsInRoom","isHost","setIsHost","roomId","setRoomId","chatList","setChatList","chatStyleRef","remake","setRemake","rejoin","setRejoin","Set","fullIds","setFullIds","addMessage","m","prev","clearMessage","current","scrollTop","scrollHeight","on","id","filter","room","removeAllListeners","type","text","isPC","query","mainStyle"],"sources":["/var/www/front-end/src/main/Main.js"],"sourcesContent":["/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useEffect, useRef, useState } from 'react';\nimport ComputerChat from './chat/ComputerChat';\nimport MobileChat from './chat/MobileChat';\nimport RoomList from './room/RoomList';\nimport { getSocket } from '../socket/socket';\nimport { useMediaQuery } from 'react-responsive';\n\nfunction Main() {\n    const [roomList, setRoomList] = useState([]);\n    const [isInRoom, setIsInRoom] = useState(false);\n    const [isHost, setIsHost] = useState(false);\n    const [roomId, setRoomId] = useState(null);\n    const [chatList, setChatList] = useState([]);\n    const chatStyleRef = useRef();\n    const [remake, setRemake] = useState(false);\n    const [rejoin, setRejoin] = useState(null);\n    const [fullIds, setFullIds] = useState(new Set()); \n\n    const addMessage = (m) => {\n        setChatList((prev) => [...prev, m]);\n    }\n\n    const clearMessage = () => {\n        setChatList([]);\n    }\n\n    useEffect(() => {\n        if (chatStyleRef.current)\n            chatStyleRef.current.scrollTop = chatStyleRef.current.scrollHeight;\n    }, [chatList])\n\n    useEffect(() => {\n        getSocket().on('roomDeleted', (id) => {\n            setRoomList((prev) => (prev.filter((room) => room.id !== id)));\n        })\n    }, [])\n\n    useEffect(() => {\n        getSocket().removeAllListeners(\"roomDeletedC\");\n        getSocket().on('roomDeletedC', () => {\n            if (isInRoom && !isHost) {\n                addMessage({ type: 'system', text: '방 삭제됨' });\n                setIsInRoom(false);\n                setIsHost(false);\n                setRoomId(null);\n            }\n        })\n\n        getSocket().removeAllListeners(\"roomQuited\");\n        getSocket().on('roomQuited', () => {\n            if (isInRoom && isHost) {\n                addMessage({ type: 'system', text: '상대 퇴장' });\n                setIsInRoom(true);\n                setIsHost(true);\n                setRoomId(roomId);\n            }\n        })\n\n    }, [isInRoom])\n\n    const isPC = useMediaQuery({query : \"(min-width: 700px)\"});\n\n    const mainStyle = css`\n        display: flex;\n        flex-direction: ${isPC ? 'row' : 'column'};\n        align-items: stretch;\n    `;\n\n    return (\n        <div className=\"main\" css={mainStyle}>\n            {isPC\n                ? <ComputerChat roomList={roomList} rejoin={rejoin} setRejoin={setRejoin} remake={remake} setRemake={setRemake} isInRoom={isInRoom} setIsInRoom={setIsInRoom} isHost={isHost} setIsHost={setIsHost} roomId={roomId} setRoomId={setRoomId} chatList={chatList} setChatList={setChatList} addMessage={addMessage} setRoomList={setRoomList} chatStyleRef={chatStyleRef} />\n                : <></>\n            }\n            <RoomList clearMessage={clearMessage} fullIds={fullIds} setFullIds={setFullIds} rejoin={rejoin} setRejoin={setRejoin} remake={remake} setRemake={setRemake} roomList={roomList} setRoomList={setRoomList} isInRoom={isInRoom} setIsInRoom={setIsInRoom} isHost={isHost} setIsHost={setIsHost} roomId={roomId} setRoomId={setRoomId} addMessage={addMessage} />\n            {isPC\n                ? <></>\n                : <MobileChat roomList={roomList} rejoin={rejoin} setRejoin={setRejoin} remake={remake} setRemake={setRemake} isInRoom={isInRoom} setIsInRoom={setIsInRoom} isHost={isHost} setIsHost={setIsHost} roomId={roomId} setRoomId={setRoomId} chatList={chatList} setChatList={setChatList} addMessage={addMessage} setRoomList={setRoomList} chatStyleRef={chatStyleRef} />\n            }\n        </div>\n    )\n}\n\nexport default Main"],"mappings":"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"},"metadata":{},"sourceType":"module"}